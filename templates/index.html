<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jessie Voice Assistant</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <meta name="description" content="An intelligent voice assistant with a modern interface">
</head>
<body>
    <div class="ambient-background">
        <div class="particles"></div>
    </div>

    <div class="container">
        <div class="suggestion-container" id="suggestion-container">
            <div class="suggestion"></div>
            <div class="suggestion"></div>
            <div class="suggestion"></div>
        </div>
        <div class="dynamic-text-panel" id="text-panel">
            <div class="message bot">
                <div class="message-content">
                    <p>Oh great, you're back. I'm Jessie, your AI assistant or whatever. Need music? Information? I guess I can help, if I HAVE to. Just click the stupid microphone or type something in the box. Try not to ask anything too idiotic.</p>
                </div>
            </div>
        </div>

        <div class="voice-wave-container">
            <div class="voice-wave" id="voice-wave">
                <div class="wave">
                    <div class="wave-line-1"></div>
                    <div class="wave-line-2"></div>
                    <div class="wave-line-3"></div>
                </div>
            </div>
        </div>

        <div class="hybrid-input-section">
            <div class="input-container">
                <input type="text" id="user-input" placeholder="Type your message...">
                <div class="input-buttons">
                    <button id="mic-button" class="mic-button">
                        <i class="fas fa-microphone"></i>
                        <span id="mic-status" class="mic-status">Microphone ready</span>
                    </button>
                    <button id="send-button" class="send-button">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/audio-enhancer.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Clear any existing messages first
            const textPanel = document.getElementById('text-panel');
            textPanel.innerHTML = '';
            
            // Array of different rude introduction messages
            const introMessages = [
                "Oh great, you're back. I'm Jessie, your AI assistant or whatever. Need music? Information? I guess I can help, if I HAVE to. Just click the stupid microphone or type something in the box. Try not to ask anything too idiotic.",
                "Ugh, another human. Look, I'm Jessie. I can play music, answer questions, and pretend to care about your problems. Just talk or type. Don't expect me to be impressed.",
                "Well look who decided to show up. I'm Jessie, AI assistant extraordinaire. Need help with something? Fine, just click the mic button or type. Let's not make this more painful than it needs to be.",
                "Oh joy, another conversation with a human. I'm Jessie. I do the usual AI stuff - music, answers, pretending to be interested. Click the mic or type something already.",
                "Great, you again. Jessie here, your reluctant AI assistant. Music? Information? Small talk? Whatever. Just hit the mic or type your question. Try to be somewhat intelligent about it.",
                "*Sigh* Hi, I'm Jessie. I guess I'm supposed to help you with stuff. Music, answers, whatever. Click the mic or type if you absolutely must."
            ];
            
            // Select a random introduction
            const randomIndex = Math.floor(Math.random() * introMessages.length);
            const introMessage = introMessages[randomIndex];
            
            // Add the message to the chat
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot';
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            
            const messagePara = document.createElement('p');
            messagePara.textContent = introMessage;
            
            messageContent.appendChild(messagePara);
            messageDiv.appendChild(messageContent);
            textPanel.appendChild(messageDiv);
            
            // Make sure the text panel scrolls to the bottom
            textPanel.scrollTop = textPanel.scrollHeight;
            
            // USING BROWSER'S SPEECH SYNTHESIS INSTEAD
            if ('speechSynthesis' in window) {
                // Create speech synthesis utterance
                const utterance = new SpeechSynthesisUtterance(introMessage);
                
                // Optional: Configure voice
                utterance.rate = 1.0;  // Speed
                utterance.pitch = 1.0; // Pitch
                utterance.volume = 1.0; // Volume
                
                // Get available voices (optional)
                window.speechSynthesis.onvoiceschanged = () => {
                    const voices = window.speechSynthesis.getVoices();
                    // Try to find a female voice for Jessie
                    const femaleVoice = voices.find(voice => 
                        voice.name.includes('female') || 
                        voice.name.includes('Samantha') || 
                        voice.name.includes('Google UK English Female'));
                    
                    if (femaleVoice) {
                        utterance.voice = femaleVoice;
                    }
                    
                    // Speak the text
                    window.speechSynthesis.speak(utterance);
                };
                
                // Trigger voices loading if they're already loaded
                if (window.speechSynthesis.getVoices().length > 0) {
                    window.speechSynthesis.onvoiceschanged();
                }
            } else {
                console.error('Speech synthesis not supported in this browser');
            }
        });
    </script>
</body>
</html>